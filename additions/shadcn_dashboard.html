<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Second Brain</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="h-full bg-gray-50" x-data="dashboard()">
    
    <!-- Header -->
    <header class="bg-white border-b border-gray-200">
        <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
            <div class="flex h-16 items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-indigo-600">
                        <span class="text-white font-semibold">üß†</span>
                    </div>
                    <h1 class="text-xl font-semibold text-gray-900">Second Brain</h1>
                </div>
                
                <div class="flex items-center gap-4">
                    <!-- Search -->
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                            </svg>
                        </div>
                        <input type="text" 
                               class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                               placeholder="Search notes..." 
                               x-model="searchQuery"
                               @input.debounce.300ms="search()">
                    </div>
                    
                    <!-- Profile -->
                    <div class="relative" x-data="{ open: false }">
                        <button @click="open = !open" class="flex items-center gap-2 text-sm font-medium text-gray-700 hover:text-gray-900">
                            <div class="h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center">
                                <span class="text-indigo-600 font-medium">DH</span>
                            </div>
                        </button>
                        
                        <div x-show="open" @click.away="open = false" x-transition
                             class="absolute right-0 z-10 mt-2 w-48 rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5">
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Settings</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Sign out</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            
            <!-- Sidebar -->
            <div class="lg:col-span-1">
                <!-- Quick Capture Card -->
                <div class="bg-white rounded-lg border border-gray-200 p-6 mb-6">
                    <h2 class="text-lg font-semibold text-gray-900 mb-4">Quick Capture</h2>
                    
                    <form @submit.prevent="captureNote()" class="space-y-4">
                        <div>
                            <textarea x-model="newNote.content" 
                                      placeholder="What's on your mind?" 
                                      rows="3"
                                      class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                        </div>
                        
                        <div>
                            <input type="text" 
                                   x-model="newNote.tags" 
                                   placeholder="Tags (comma separated)"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                        
                        <div class="flex items-center gap-2">
                            <input type="file" 
                                   accept="audio/*" 
                                   @change="handleFileUpload($event)"
                                   class="hidden" 
                                   id="audio-upload">
                            <label for="audio-upload" 
                                   class="cursor-pointer inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                                <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 016 0v6a3 3 0 01-3 3z" />
                                </svg>
                                Audio
                            </label>
                            
                            <button type="button" 
                                    @click="startRecording()"
                                    :class="recording ? 'bg-red-500 hover:bg-red-600' : 'bg-gray-500 hover:bg-gray-600'"
                                    class="inline-flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium text-white">
                                <span x-text="recording ? 'Stop' : 'Record'"></span>
                            </button>
                        </div>
                        
                        <button type="submit" 
                                :disabled="!newNote.content && !newNote.audioFile"
                                class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-gray-300">
                            <span x-show="!capturing">Save Note</span>
                            <span x-show="capturing">Saving...</span>
                        </button>
                    </form>
                </div>
                
                <!-- Stats Card -->
                <div class="bg-white rounded-lg border border-gray-200 p-6 mb-6">
                    <h3 class="text-sm font-medium text-gray-900 mb-4">Overview</h3>
                    <dl class="space-y-3">
                        <div class="flex justify-between">
                            <dt class="text-sm text-gray-500">Total Notes</dt>
                            <dd class="text-sm font-medium text-gray-900" x-text="stats.totalNotes"></dd>
                        </div>
                        <div class="flex justify-between">
                            <dt class="text-sm text-gray-500">This Week</dt>
                            <dd class="text-sm font-medium text-gray-900" x-text="stats.thisWeek"></dd>
                        </div>
                        <div class="flex justify-between">
                            <dt class="text-sm text-gray-500">Audio Notes</dt>
                            <dd class="text-sm font-medium text-gray-900" x-text="stats.audioNotes"></dd>
                        </div>
                    </dl>
                </div>
                
                <!-- Tags -->
                <div class="bg-white rounded-lg border border-gray-200 p-6">
                    <h3 class="text-sm font-medium text-gray-900 mb-4">Popular Tags</h3>
                    <div class="flex flex-wrap gap-2">
                        <template x-for="tag in popularTags" :key="tag.name">
                            <button @click="filterByTag(tag.name)"
                                    class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 hover:bg-indigo-200">
                                <span x-text="tag.name"></span>
                                <span class="ml-1 text-indigo-600" x-text="tag.count"></span>
                            </button>
                        </template>
                    </div>
                </div>
            </div>
            
            <!-- Main Timeline -->
            <div class="lg:col-span-3">
                <!-- Filter Tabs -->
                <div class="mb-6">
                    <nav class="flex space-x-8">
                        <template x-for="filter in filters" :key="filter.key">
                            <button @click="activeFilter = filter.key"
                                    :class="activeFilter === filter.key ? 'border-indigo-500 text-indigo-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                                    class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm">
                                <span x-text="filter.label"></span>
                                <span class="ml-2 py-0.5 px-2 rounded-full text-xs bg-gray-100 text-gray-900" x-text="filter.count"></span>
                            </button>
                        </template>
                    </nav>
                </div>
                
                <!-- Notes Grid -->
                <div class="space-y-6">
                    <template x-for="group in groupedNotes" :key="group.date">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 mb-4" x-text="group.label"></h3>
                            <div class="grid gap-4">
                                <template x-for="note in group.notes" :key="note.id">
                                    <div class="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer"
                                         @click="openNote(note.id)">
                                        
                                        <div class="flex items-start justify-between mb-3">
                                            <div class="flex items-center gap-2">
                                                <div :class="note.type === 'audio' ? 'bg-yellow-100 text-yellow-800' : 'bg-blue-100 text-blue-800'"
                                                     class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium">
                                                    <span x-show="note.type === 'audio'">üéôÔ∏è Audio</span>
                                                    <span x-show="note.type === 'note'">üìù Note</span>
                                                    <span x-show="note.type === 'apple'">üì± Shortcut</span>
                                                </div>
                                                <span x-show="note.status === 'pending'"
                                                      class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                                                    Processing...
                                                </span>
                                            </div>
                                            <span class="text-xs text-gray-500" x-text="formatTime(note.timestamp)"></span>
                                        </div>
                                        
                                        <h4 class="text-lg font-semibold text-gray-900 mb-2" x-text="note.title"></h4>
                                        
                                        <p class="text-gray-600 text-sm mb-3 line-clamp-3" x-text="note.summary"></p>
                                        
                                        <div x-show="note.actions && note.actions.length > 0" class="mb-3">
                                            <h5 class="text-xs font-medium text-gray-700 mb-1">Action Items:</h5>
                                            <ul class="text-xs text-gray-600 space-y-1">
                                                <template x-for="action in note.actions.slice(0, 2)" :key="action">
                                                    <li class="flex items-start gap-1">
                                                        <span class="text-indigo-500">‚Ä¢</span>
                                                        <span x-text="action"></span>
                                                    </li>
                                                </template>
                                            </ul>
                                        </div>
                                        
                                        <div x-show="note.tags && note.tags.length > 0" class="flex flex-wrap gap-1">
                                            <template x-for="tag in note.tags.slice(0, 4)" :key="tag">
                                                <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800">
                                                    #<span x-text="tag"></span>
                                                </span>
                                            </template>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </div>
    </div>

    <script>
        function dashboard() {
            return {
                searchQuery: '',
                activeFilter: 'all',
                recording: false,
                capturing: false,
                newNote: {
                    content: '',
                    tags: '',
                    audioFile: null
                },
                
                // Mock data - replace with real API calls
                stats: {
                    totalNotes: 247,
                    thisWeek: 23,
                    audioNotes: 45
                },
                
                filters: [
                    { key: 'all', label: 'All Notes', count: 247 },
                    { key: 'today', label: 'Today', count: 5 },
                    { key: 'audio', label: 'Audio', count: 45 },
                    { key: 'pending', label: 'Processing', count: 2 }
                ],
                
                popularTags: [
                    { name: 'meeting', count: 23 },
                    { name: 'idea', count: 18 },
                    { name: 'project', count: 15 },
                    { name: 'todo', count: 12 }
                ],
                
                notes: [
                    {
                        id: 1,
                        title: 'Team Meeting Notes',
                        summary: 'Discussed Q1 planning and new feature roadmap. Key decisions made about user authentication and API design.',
                        type: 'audio',
                        status: 'complete',
                        timestamp: '2025-01-12T14:30:00Z',
                        tags: ['meeting', 'planning', 'team'],
                        actions: ['Review API documentation', 'Schedule follow-up with design team']
                    },
                    {
                        id: 2,
                        title: 'Product Idea - Voice Commands',
                        summary: 'Brainstormed ideas for voice-activated note taking. Could integrate with existing audio transcription.',
                        type: 'note',
                        status: 'complete',
                        timestamp: '2025-01-12T10:15:00Z',
                        tags: ['idea', 'product', 'voice'],
                        actions: ['Research voice command libraries', 'Create prototype']
                    },
                    {
                        id: 3,
                        title: 'Daily Standup',
                        summary: 'Processing audio transcript...',
                        type: 'audio',
                        status: 'pending',
                        timestamp: '2025-01-12T09:00:00Z',
                        tags: ['meeting', 'standup'],
                        actions: []
                    }
                ],
                
                get groupedNotes() {
                    const filtered = this.notes.filter(note => {
                        if (this.activeFilter === 'all') return true;
                        if (this.activeFilter === 'today') {
                            const today = new Date().toISOString().split('T')[0];
                            return note.timestamp.startsWith(today);
                        }
                        if (this.activeFilter === 'audio') return note.type === 'audio';
                        if (this.activeFilter === 'pending') return note.status === 'pending';
                        return true;
                    });
                    
                    const groups = {};
                    filtered.forEach(note => {
                        const date = note.timestamp.split('T')[0];
                        if (!groups[date]) {
                            groups[date] = [];
                        }
                        groups[date].push(note);
                    });
                    
                    return Object.entries(groups).map(([date, notes]) => ({
                        date,
                        label: this.formatDate(date),
                        notes
                    }));
                },
                
                formatDate(dateStr) {
                    const date = new Date(dateStr);
                    const today = new Date();
                    const yesterday = new Date(today);
                    yesterday.setDate(yesterday.getDate() - 1);
                    
                    if (dateStr === today.toISOString().split('T')[0]) return 'Today';
                    if (dateStr === yesterday.toISOString().split('T')[0]) return 'Yesterday';
                    
                    return date.toLocaleDateString('en-US', { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    });
                },
                
                formatTime(timestamp) {
                    return new Date(timestamp).toLocaleTimeString('en-US', { 
                        hour: 'numeric', 
                        minute: '2-digit' 
                    });
                },
                
                async captureNote() {
                    this.capturing = true;
                    try {
                        // Simulate API call
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        
                        // Add to notes list
                        const newNote = {
                            id: Date.now(),
                            title: this.newNote.content.slice(0, 50) + '...',
                            summary: this.newNote.content,
                            type: this.newNote.audioFile ? 'audio' : 'note',
                            status: this.newNote.audioFile ? 'pending' : 'complete',
                            timestamp: new Date().toISOString(),
                            tags: this.newNote.tags.split(',').map(t => t.trim()).filter(Boolean),
                            actions: []
                        };
                        
                        this.notes.unshift(newNote);
                        
                        // Reset form
                        this.newNote = { content: '', tags: '', audioFile: null };
                    } finally {
                        this.capturing = false;
                    }
                },
                
                handleFileUpload(event) {
                    this.newNote.audioFile = event.target.files[0];
                },
                
                startRecording() {
                    this.recording = !this.recording;
                    // Implement actual recording logic
                },
                
                search() {
                    // Implement search logic
                    console.log('Searching for:', this.searchQuery);
                },
                
                filterByTag(tagName) {
                    this.searchQuery = `#${tagName}`;
                    this.search();
                },
                
                openNote(noteId) {
                    // Navigate to note detail
                    window.location.href = `/detail/${noteId}`;
                }
            }
        }
    </script>
</body>
</html>