<!DOCTYPE html>
<html>
<head>
  <title>Second Brain â€“ Timeline</title>
  <link rel="stylesheet" href="/static/css/dark.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { background: #181b28; color: #d3e3fc; font-family: 'Inter', Arial, sans-serif;}
    .timeline { margin: 2em auto; max-width: 820px; }
    .day-group { margin-bottom: 2em; }
    .day-label { color: #81aaff; font-size: 1.22em; margin-bottom: 0.5em; border-left: 4px solid #81aaff; padding-left: 13px; font-weight: bold;}
    .note-timeline {
      display: flex;
      align-items: flex-start;
      gap: 1.4em;
      margin-bottom: 1em;
      background: #202a3a;
      border-radius: 10px;
      padding: 1em 1.4em;
      box-shadow: 0 1px 10px #0003;
      transition: background 0.2s;
      cursor: pointer;
    }
    .note-timeline:hover { background: #252d43; }
    .bubble-time {
      background: #232c4e;
      color: #81aaff;
      font-size: 1em;
      padding: 0.6em 1em;
      border-radius: 50px;
      font-weight: bold;
      min-width: 60px;
      text-align: center;
      margin-top: 8px;
    }
    .note-content { flex: 1; }
    .note-title { font-size: 1.08em; font-weight: bold; margin-bottom: 0.16em; color:#83bfff;}
    .note-summary { color: #d1c8ff; margin-bottom: 0.32em; }
    .note-tags { color: #68e3fc; font-size: 0.98em; margin-bottom: 0.2em; }
    .note-type { font-size: 0.94em; color: #ffb47d; }
    a { color: #81aaff; text-decoration: none;}
    a.tag-link { color: #52ebff; background: #181d28; border-radius: 6px; padding: 2px 7px; font-size:0.98em; margin-right:4px;}
    form { margin:2em auto; max-width:780px; text-align:center;}
    input[type=text] { padding:0.7em;width:62%;border-radius:9px;font-size:1.1em;background:#242a36;color:#81aaff;border:1px solid #23273e;}
    button[type=submit] { padding:0.7em 1.2em;border-radius:9px;font-size:1.1em;background:#81aaff;color:#222;font-weight:bold;}
    @media (max-width: 600px) {
      .timeline { max-width: 98vw; padding:0 0.4em;}
      .note-timeline { flex-direction: column; gap: 0.7em;}
      .bubble-time { margin-top:0; margin-bottom: 8px;}
    }
  </style>
</head>
<body>
  <h1 style="margin-bottom:1.4em;text-align:center;">ðŸ“… Timeline</h1>
  <form method="get">
    <input type="text" name="q" placeholder="Search your notes..." value="{{ q or '' }}">
    <button type="submit">Search</button>
    {% if q %}
      <a href="/" style="margin-left:20px;color:#ff88ff;text-decoration:underline;">Clear search</a>
    {% endif %}
    {% if tag %}
      <span style="margin-left:20px;color:#00ffc3;">Tag: #{{ tag }}</span>
      <a href="/" style="margin-left:10px;color:#f8cc81;text-decoration:underline;">Clear filter</a>
    {% endif %}
  </form>

  <div class="timeline">
    {% for day, notes_on_day in notes_by_day.items() %}
      <div class="day-group">
        <div class="day-label">{{ day }}</div>
        {% for note in notes_on_day %}
          <div class="note-timeline" onclick="window.location='/detail/{{ note['id'] }}'">
            <div class="bubble-time">{{ note['timestamp'][11:16] }}</div>
            <div class="note-content">
              <div class="note-title">
                <a href="/detail/{{ note['id'] }}">{{ note['title']|highlight(q) }}</a>
                {% if note['type'] != 'note' %}
                  <span class="note-type">({{ note['type'] }})</span>
                {% endif %}
              </div>
              <div class="note-summary">{{ note['summary']|highlight(q) }}</div>
              <div class="note-tags">
                {% for tag_ in note['tags'].split(',') if tag_.strip() %}
                  <a href="/?tag={{ tag_.strip() }}" class="tag-link">#{{ tag_.strip()|highlight(q) }}</a>
                {% endfor %}
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% endfor %}
    {% if not notes_by_day %}
      <p style="margin:2em;text-align:center;color:#fab2bf;">No notes found. Try capturing a new thought or search for something else!</p>
    {% endif %}
  </div>
</body>
</html>
