<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iOS Shortcuts Setup - Second Brain</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h1 class="text-3xl font-bold text-gray-900 mb-6">
                üì± iOS Shortcuts Setup
            </h1>
            
            <div class="prose max-w-none">
                <p class="text-lg text-gray-700 mb-8">
                    Set up iOS Shortcuts to capture content directly to your Second Brain from anywhere on your iPhone or iPad.
                </p>

                <!-- Quick Setup Section -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8">
                    <h2 class="text-xl font-semibold text-blue-900 mb-4">üöÄ Quick Setup</h2>
                    <div class="space-y-4">
                        <div class="flex items-center space-x-3">
                            <span class="bg-blue-500 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold">1</span>
                            <span>Download and install the <strong>Shortcuts app</strong> from the App Store</span>
                        </div>
                        <div class="flex items-center space-x-3">
                            <span class="bg-blue-500 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold">2</span>
                            <span>Get your API token: <code class="bg-gray-100 px-2 py-1 rounded text-sm">{{ user.api_token }}</code></span>
                        </div>
                        <div class="flex items-center space-x-3">
                            <span class="bg-blue-500 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold">3</span>
                            <span>Choose from our pre-built shortcuts below</span>
                        </div>
                    </div>
                </div>

                <!-- Pre-built Shortcuts -->
                <h2 class="text-2xl font-bold text-gray-900 mb-6">üîó Ready-to-Use Shortcuts</h2>
                
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <!-- Web Clip Shortcut -->
                    <div class="border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="text-2xl mr-3">üåê</span>
                            <h3 class="text-lg font-semibold">Web Clip Saver</h3>
                        </div>
                        <p class="text-gray-600 mb-4">Save articles and web pages from Safari with full content extraction.</p>
                        <a href="shortcuts://import-shortcut?url={{ base_url }}/shortcuts/web-clip.shortcut" 
                           class="bg-blue-500 text-white px-4 py-2 rounded-lg inline-block hover:bg-blue-600 transition">
                            üì• Add Shortcut
                        </a>
                    </div>

                    <!-- Quick Note -->
                    <div class="border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="text-2xl mr-3">üìù</span>
                            <h3 class="text-lg font-semibold">Quick Note</h3>
                        </div>
                        <p class="text-gray-600 mb-4">Instantly capture text notes with smart tagging and location data.</p>
                        <a href="shortcuts://import-shortcut?url={{ base_url }}/shortcuts/quick-note.shortcut" 
                           class="bg-blue-500 text-white px-4 py-2 rounded-lg inline-block hover:bg-blue-600 transition">
                            üì• Add Shortcut
                        </a>
                    </div>

                    <!-- Photo OCR -->
                    <div class="border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="text-2xl mr-3">üì∏</span>
                            <h3 class="text-lg font-semibold">Photo Text Extractor</h3>
                        </div>
                        <p class="text-gray-600 mb-4">Capture text from photos, documents, and signs using OCR.</p>
                        <a href="shortcuts://import-shortcut?url={{ base_url }}/shortcuts/photo-ocr.shortcut" 
                           class="bg-blue-500 text-white px-4 py-2 rounded-lg inline-block hover:bg-blue-600 transition">
                            üì• Add Shortcut
                        </a>
                    </div>

                    <!-- Voice Memo -->
                    <div class="border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="text-2xl mr-3">üé§</span>
                            <h3 class="text-lg font-semibold">Voice to Text</h3>
                        </div>
                        <p class="text-gray-600 mb-4">Record voice memos with automatic transcription and intelligent processing.</p>
                        <a href="shortcuts://import-shortcut?url={{ base_url }}/shortcuts/voice-memo.shortcut" 
                           class="bg-blue-500 text-white px-4 py-2 rounded-lg inline-block hover:bg-blue-600 transition">
                            üì• Add Shortcut
                        </a>
                    </div>

                    <!-- Task Creator -->
                    <div class="border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="text-2xl mr-3">‚úÖ</span>
                            <h3 class="text-lg font-semibold">Task Creator</h3>
                        </div>
                        <p class="text-gray-600 mb-4">Create tasks and reminders with due dates and priority levels.</p>
                        <a href="shortcuts://import-shortcut?url={{ base_url }}/shortcuts/task-creator.shortcut" 
                           class="bg-blue-500 text-white px-4 py-2 rounded-lg inline-block hover:bg-blue-600 transition">
                            üì• Add Shortcut
                        </a>
                    </div>

                    <!-- Contact Saver -->
                    <div class="border border-gray-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <span class="text-2xl mr-3">üë§</span>
                            <h3 class="text-lg font-semibold">Contact Saver</h3>
                        </div>
                        <p class="text-gray-600 mb-4">Save contact information and meeting notes from your contacts app.</p>
                        <a href="shortcuts://import-shortcut?url={{ base_url }}/shortcuts/contact-saver.shortcut" 
                           class="bg-blue-500 text-white px-4 py-2 rounded-lg inline-block hover:bg-blue-600 transition">
                            üì• Add Shortcut
                        </a>
                    </div>
                </div>

                <!-- Manual Setup Instructions -->
                <h2 class="text-2xl font-bold text-gray-900 mb-6">üîß Manual Setup Instructions</h2>
                
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-6 mb-8">
                    <h3 class="text-lg font-semibold mb-4">Creating Your Own Shortcuts</h3>
                    
                    <div class="space-y-6">
                        <div>
                            <h4 class="font-semibold text-gray-900 mb-2">1. Basic Setup</h4>
                            <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4">
                                <li>Open the Shortcuts app</li>
                                <li>Tap the "+" to create a new shortcut</li>
                                <li>Add a "Get My Shortcuts" action</li>
                                <li>Add a "Request" action (Web ‚Üí Make Request)</li>
                            </ul>
                        </div>

                        <div>
                            <h4 class="font-semibold text-gray-900 mb-2">2. Configure the Request</h4>
                            <div class="bg-white border rounded p-4">
                                <div class="grid md:grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <strong>URL:</strong><br>
                                        <code class="bg-gray-100 p-1 rounded block mt-1">{{ base_url }}/api/mobile/shortcuts/capture</code>
                                    </div>
                                    <div>
                                        <strong>Method:</strong><br>
                                        <code class="bg-gray-100 p-1 rounded block mt-1">POST</code>
                                    </div>
                                    <div>
                                        <strong>Headers:</strong><br>
                                        <code class="bg-gray-100 p-1 rounded block mt-1">
                                            Content-Type: application/json<br>
                                            Authorization: Bearer {{ user.api_token }}
                                        </code>
                                    </div>
                                    <div>
                                        <strong>Body:</strong><br>
                                        <code class="bg-gray-100 p-1 rounded block mt-1">JSON</code>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h4 class="font-semibold text-gray-900 mb-2">3. JSON Body Examples</h4>
                            <div class="space-y-4">
                                <div>
                                    <strong>Simple Text Note:</strong>
                                    <pre class="bg-black text-green-400 p-4 rounded mt-2 text-sm overflow-x-auto"><code>{
  "type": "text",
  "content": "Your note content here",
  "source_app": "iOS Shortcuts"
}</code></pre>
                                </div>
                                
                                <div>
                                    <strong>Web Article:</strong>
                                    <pre class="bg-black text-green-400 p-4 rounded mt-2 text-sm overflow-x-auto"><code>{
  "type": "web_clip",
  "title": "Article Title",
  "url": "https://example.com/article",
  "content": "Article content...",
  "source_app": "Safari"
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Integration Tips -->
                <h2 class="text-2xl font-bold text-gray-900 mb-6">üí° Integration Tips</h2>
                
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6">
                        <h3 class="font-semibold text-yellow-900 mb-3">üìã Share Sheet Integration</h3>
                        <p class="text-yellow-800 text-sm">
                            Enable "Use with Share Sheet" in your shortcut settings to capture content from any app that supports sharing.
                        </p>
                    </div>
                    
                    <div class="bg-green-50 border border-green-200 rounded-lg p-6">
                        <h3 class="font-semibold text-green-900 mb-3">üéØ Siri Integration</h3>
                        <p class="text-green-800 text-sm">
                            Add custom Siri phrases to your shortcuts for hands-free capture: "Hey Siri, save this to my brain"
                        </p>
                    </div>
                    
                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-6">
                        <h3 class="font-semibold text-purple-900 mb-3">üïí Automation</h3>
                        <p class="text-purple-800 text-sm">
                            Create personal automations to trigger captures based on time, location, or app usage.
                        </p>
                    </div>
                    
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                        <h3 class="font-semibold text-blue-900 mb-3">üè∑Ô∏è Smart Tagging</h3>
                        <p class="text-blue-800 text-sm">
                            Include location data, current app, or custom tags in your JSON payload for automatic organization.
                        </p>
                    </div>
                </div>

                <!-- Testing Section -->
                <h2 class="text-2xl font-bold text-gray-900 mb-6">üß™ Test Your Setup</h2>
                
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-6 mb-8">
                    <h3 class="text-lg font-semibold mb-4">Quick Test</h3>
                    <p class="text-gray-700 mb-4">
                        Use this simple test to verify your shortcuts are working correctly:
                    </p>
                    
                    <form id="testForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Test Content:</label>
                            <textarea class="w-full border border-gray-300 rounded px-3 py-2" rows="3" placeholder="Enter some test content..."></textarea>
                        </div>
                        <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition">
                            üß™ Send Test
                        </button>
                    </form>
                    
                    <div id="testResult" class="mt-4 hidden">
                        <div class="bg-green-100 border border-green-400 rounded p-3">
                            <p class="text-green-700">‚úÖ Test successful! Check your dashboard for the new note.</p>
                        </div>
                    </div>
                </div>

                <!-- Troubleshooting -->
                <h2 class="text-2xl font-bold text-gray-900 mb-6">üîß Troubleshooting</h2>
                
                <div class="space-y-4">
                    <details class="border border-gray-200 rounded-lg">
                        <summary class="p-4 cursor-pointer font-medium">Shortcut not working</summary>
                        <div class="p-4 border-t border-gray-200">
                            <ul class="list-disc list-inside space-y-2 text-sm text-gray-700">
                                <li>Check your API token is correct</li>
                                <li>Verify the server URL is accessible</li>
                                <li>Ensure you have an internet connection</li>
                                <li>Check the shortcut's execution log for errors</li>
                            </ul>
                        </div>
                    </details>
                    
                    <details class="border border-gray-200 rounded-lg">
                        <summary class="p-4 cursor-pointer font-medium">Content not appearing in dashboard</summary>
                        <div class="p-4 border-t border-gray-200">
                            <ul class="list-disc list-inside space-y-2 text-sm text-gray-700">
                                <li>Refresh your dashboard page</li>
                                <li>Check that you're logged into the correct account</li>
                                <li>Verify the JSON payload format is correct</li>
                                <li>Look for error responses in the shortcut results</li>
                            </ul>
                        </div>
                    </details>
                    
                    <details class="border border-gray-200 rounded-lg">
                        <summary class="p-4 cursor-pointer font-medium">Share sheet not showing shortcut</summary>
                        <div class="p-4 border-t border-gray-200">
                            <ul class="list-disc list-inside space-y-2 text-sm text-gray-700">
                                <li>Enable "Use with Share Sheet" in shortcut settings</li>
                                <li>Make sure the shortcut accepts the right content types</li>
                                <li>Restart the app you're trying to share from</li>
                                <li>Check that the shortcut is not disabled</li>
                            </ul>
                        </div>
                    </details>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Test form functionality
        document.getElementById('testForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const content = this.querySelector('textarea').value;
            if (!content) return;
            
            try {
                const response = await fetch('/api/mobile/shortcuts/capture', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer {{ user.api_token }}'
                    },
                    body: JSON.stringify({
                        type: 'test',
                        content: content,
                        source_app: 'Setup Page Test'
                    })
                });
                
                if (response.ok) {
                    document.getElementById('testResult').classList.remove('hidden');
                    this.reset();
                } else {
                    throw new Error('Test failed');
                }
            } catch (error) {
                alert('Test failed. Please check your setup and try again.');
            }
        });
    </script>
</body>
</html>